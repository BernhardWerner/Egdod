<!DOCTYPE html>
<html lang="en">
 <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Egdod test</title>
    <script type="text/javascript" src="https://cindyjs.org/dist/v0.8/Cindy.js"></script>
    <script type="text/javascript" src="https://cindyjs.org/dist/v0.8/CindyGL.js"></script>
    <script type="text/javascript" src="cindyLoader.js"></script>

  </head>

<body style="font-family:Palatino; margin:0; font-size:16pt">



<script id='csinit' type='text/x-cindyscript'>

project() := (
  //drawOrder = sort(1..length(points3D), -dist(points3D_#, camera.position));
  //pointsScreen = apply(points3D, projectToScreen(#, camera));
  linesProjected = apply(gridLines, line, apply(line, projectToScreen(#, camera)));
);


rad = 10;
polar = 60°;
camera = {
  "position": sphericalCoordinates(rad, 0°, polar),
  "lookAt": [0, 0, 0],
  "up": [0, 0, 1],
  "fov": pi / 3
};


//points3D = apply(1..1000, 3 * [2 * random() - 1, 2 * random() - 1, 2 * random() - 1]);
//pointsScreen = [];
//drawOrder = [];
//project();

f(x, y) := 4 - 0.3 * x^2 - 0.2 * y^2;

numberOfLines = 4;
gridLines = apply(-numberOfLines..numberOfLines, x, apply(1..48, 
  y = lerp(-numberOfLines - 0.5, numberOfLines + 0.5, #, 1, 48);
  [x, y, f(x, y)];
)) ++ apply(-numberOfLines..numberOfLines, y, apply(1..48, 
  x = lerp(-numberOfLines - 0.5, numberOfLines + 0.5, #, 1, 48);
  [x, y, f(x, y)];
));
project();



setupTime();
playanimation();
</script>



<script id='csdraw' type='text/x-cindyscript'>
//forall(drawOrder, 
//  fillcircle(pointsScreen_#, 4 / dist(points3D_#, camera.position) + 0.04, color -> (1,1,1));
//  fillcircle(pointsScreen_#, 4 / dist(points3D_#, camera.position), color -> sapColor.blue1);
//);

forall(gridLines, line,
  forall(consecutive(line),
    edge = [projectToScreen(#_1, camera), projectToScreen(#_2, camera)];
    draw(edge, size -> 10 / dist((#_1 + #_2) / 2, camera.position), alpha -> 1 - dist((#_1 + #_2) / 2, camera.position) / 20);
  );
);

drawtext(canvasCorners.bl + [1,1], delta);

</script>



<script id='cstick' type='text/x-cindyscript'>
delta = deltaTime();

camera.position = sphericalCoordinates(rad, 0.5 * now(), polar);
//project();

</script>


<script id='csmousemove' type='text/x-cindyscript'>


</script>

<script id='csmousedown' type='text/x-cindyscript'>

</script>

<script id='csmousedrag' type='text/x-cindyscript'>
</script>

<script id='csmouseup' type='text/x-cindyscript'>
</script>

<!-- <script id='cskeydown' type='text/x-cindyscript'>
</script> -->


<canvas id="CSCanvas" align="left" valign="top" width="800" height="800" style="border:1px solid #000000;"></canvas>




<script>
cindy = startCindy({
  canvasname:"CSCanvas",
    scripts:"cs*",
    images: {},
    //use: ["katex"],
    import: ["egdod", "colorPalettes"]
});
</script>







<script>

</script>






</body>

</html>
